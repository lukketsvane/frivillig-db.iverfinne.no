{
  "name": "searchOrganizations",
  "description": "Search Norwegian volunteer organizations database with full-text search, location filtering, and relevance sorting. Returns structured organization data including contact info and activities. Server-side authenticated endpoint.",
  "input_schema": {
    "type": "object",
    "properties": {
      "query": {
        "type": "string",
        "description": "Full-text search query for organization name, activities (aktivitet), or purpose (vedtektsfestet_formaal). Supports Norwegian text. Empty string returns location-filtered results only."
      },
      "location": {
        "type": "string",
        "description": "Location filter matching poststed (city), kommune (municipality), or fylke (county). Case-insensitive partial match. Example: 'Oslo', 'Bergen', 'Trondheim'."
      },
      "fylke": {
        "type": "string",
        "description": "Filter by specific Norwegian county (fylke). Example: 'Oslo', 'Viken', 'Rogaland', 'Vestland'."
      },
      "kommune": {
        "type": "string",
        "description": "Filter by specific municipality (kommune). Example: 'Oslo', 'Bergen', 'Trondheim', 'Stavanger'."
      },
      "poststed": {
        "type": "string",
        "description": "Filter by postal city (poststed)."
      },
      "postnummer": {
        "type": "string",
        "description": "Filter by postal code (4-digit Norwegian postal code). Example: '0150', '5020', '7030'."
      },
      "naeringskode": {
        "type": "string",
        "description": "Filter by industry code description (naeringskode). Partial match on naeringskode1_beskrivelse."
      },
      "organisasjonsform": {
        "type": "string",
        "description": "Filter by organization type (organisasjonsform_beskrivelse). Example: 'Forening', 'Stiftelse', 'Lag'."
      },
      "sort": {
        "type": "string",
        "enum": ["relevance", "name", "stiftelsesdato", "registreringsdato_frivillighetsregisteret"],
        "default": "relevance",
        "description": "Sort field: 'relevance' (text search score), 'name' (alphabetical), 'stiftelsesdato' (founding date), 'registreringsdato_frivillighetsregisteret' (registry date)."
      },
      "order": {
        "type": "string",
        "enum": ["asc", "desc"],
        "default": "desc",
        "description": "Sort order: 'asc' (ascending) or 'desc' (descending). Default 'desc' for dates, 'asc' for name."
      },
      "limit": {
        "type": "integer",
        "minimum": 1,
        "maximum": 100,
        "default": 20,
        "description": "Maximum number of results to return (1-100)."
      },
      "offset": {
        "type": "integer",
        "minimum": 0,
        "default": 0,
        "description": "Number of results to skip for pagination."
      },
      "include_contact": {
        "type": "boolean",
        "default": true,
        "description": "Include contact fields (hjemmeside, epost, telefon, mobiltelefon)."
      },
      "include_detailed": {
        "type": "boolean",
        "default": false,
        "description": "Include detailed fields (organisasjonsnummer, naeringskoder, antall_ansatte, all addresses)."
      },
      "only_with_website": {
        "type": "boolean",
        "default": false,
        "description": "Return only organizations with a website (hjemmeside IS NOT NULL)."
      },
      "only_with_email": {
        "type": "boolean",
        "default": false,
        "description": "Return only organizations with email (epost IS NOT NULL)."
      }
    },
    "required": [],
    "additionalProperties": false
  },
  "response_schema": {
    "type": "object",
    "required": ["data", "meta"],
    "properties": {
      "data": {
        "type": "array",
        "description": "Array of organization objects matching search criteria.",
        "items": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "format": "uuid",
              "description": "Unique organization ID"
            },
            "navn": {
              "type": "string",
              "description": "Organization name"
            },
            "slug": {
              "type": "string",
              "description": "URL-friendly slug for organization page"
            },
            "aktivitet": {
              "type": ["string", "null"],
              "description": "Description of organization activities"
            },
            "vedtektsfestet_formaal": {
              "type": ["string", "null"],
              "description": "Statutory purpose of the organization"
            },
            "organisasjonsform_beskrivelse": {
              "type": ["string", "null"],
              "description": "Type of organization (e.g., Forening, Stiftelse)"
            },
            "naeringskode1_beskrivelse": {
              "type": ["string", "null"],
              "description": "Primary industry classification"
            },
            "forretningsadresse_poststed": {
              "type": ["string", "null"],
              "description": "Business address city"
            },
            "forretningsadresse_kommune": {
              "type": ["string", "null"],
              "description": "Business address municipality"
            },
            "forretningsadresse_postnummer": {
              "type": ["string", "null"],
              "description": "Business address postal code"
            },
            "forretningsadresse_adresse": {
              "type": ["string", "null"],
              "description": "Business street address"
            },
            "fylke": {
              "type": ["string", "null"],
              "description": "County (fylke)"
            },
            "hjemmeside": {
              "type": ["string", "null"],
              "description": "Website URL (if include_contact=true)"
            },
            "epost": {
              "type": ["string", "null"],
              "description": "Email address (if include_contact=true)"
            },
            "telefon": {
              "type": ["string", "null"],
              "description": "Phone number (if include_contact=true)"
            },
            "mobiltelefon": {
              "type": ["string", "null"],
              "description": "Mobile phone (if include_detailed=true)"
            },
            "organisasjonsnummer": {
              "type": ["string", "null"],
              "description": "Official organization number (if include_detailed=true)"
            },
            "antall_ansatte": {
              "type": ["integer", "null"],
              "description": "Number of employees (if include_detailed=true)"
            },
            "stiftelsesdato": {
              "type": ["string", "null"],
              "format": "date",
              "description": "Founding date (if include_detailed=true)"
            },
            "registreringsdato_frivillighetsregisteret": {
              "type": ["string", "null"],
              "format": "date",
              "description": "Volunteer registry registration date (if include_detailed=true)"
            }
          },
          "required": ["id", "navn"],
          "additionalProperties": false
        }
      },
      "meta": {
        "type": "object",
        "required": ["total", "limit", "offset", "returned"],
        "properties": {
          "total": {
            "type": "integer",
            "description": "Total number of matching organizations (may be estimated for large result sets)"
          },
          "limit": {
            "type": "integer",
            "description": "Maximum results per page"
          },
          "offset": {
            "type": "integer",
            "description": "Current pagination offset"
          },
          "returned": {
            "type": "integer",
            "description": "Actual number of results returned in this response"
          },
          "has_more": {
            "type": "boolean",
            "description": "Whether more results are available (offset + returned < total)"
          },
          "query_time_ms": {
            "type": "number",
            "description": "Server query execution time in milliseconds (optional)"
          }
        },
        "additionalProperties": false
      }
    },
    "additionalProperties": false
  },
  "errors": {
    "400": {
      "description": "Bad request: Invalid parameters (e.g., limit > 100, invalid UUID)"
    },
    "401": {
      "description": "Unauthorized: Missing or invalid authentication"
    },
    "429": {
      "description": "Rate limited: Too many requests"
    },
    "500": {
      "description": "Internal server error"
    }
  },
  "examples": [
    {
      "name": "search_by_activity",
      "description": "Search for youth organizations in Oslo",
      "input": {
        "query": "ungdom barn aktiviteter",
        "location": "Oslo",
        "limit": 10,
        "include_contact": true
      }
    },
    {
      "name": "location_filter",
      "description": "List all organizations in Vestland county",
      "input": {
        "fylke": "Vestland",
        "limit": 50,
        "sort": "name",
        "order": "asc"
      }
    },
    {
      "name": "search_with_contact_filter",
      "description": "Find sports organizations with websites in Bergen",
      "input": {
        "query": "idrett sport",
        "poststed": "Bergen",
        "only_with_website": true,
        "limit": 20
      }
    },
    {
      "name": "detailed_search",
      "description": "Search cultural organizations with full details",
      "input": {
        "query": "kultur kunst musikk",
        "include_detailed": true,
        "include_contact": true,
        "limit": 15
      }
    }
  ],
  "notes": [
    "All organizations returned are registered in the Norwegian volunteer registry (registrert_i_frivillighetsregisteret=true).",
    "The 'query' parameter supports Norwegian language full-text search across name, aktivitet, and vedtektsfestet_formaal fields.",
    "Location filters use case-insensitive partial matching (ILIKE) and can be combined (e.g., fylke + kommune).",
    "The 'slug' field is auto-generated from 'navn' for use in URLs: /organisasjon/{slug}",
    "For best performance with large result sets, use specific location filters and limit results.",
    "Text search uses PostgreSQL tsvector with Norwegian language stemming when available.",
    "Response times: Simple queries <50ms, complex text searches <200ms (typical)."
  ]
}
